==========
ibtopotool
==========

ibtopotool is a tool that can parse an Infiniband topology file (as
generated by 'ibnetdiscover'), and do things. So far it supports:

- Generate a graphviz dot file for visualizing the IB network.

- Generate a slurm topology.conf configuration file.


Dependencies
============

This tool uses the `NetworkX library <https://networkx.github.io/>`_
version 2.x or newer to represent the nodes and links between
them. The easiest way is probably to use the Anaconda python
distribution.

In order to generate a slurm topology file, the `python-hostlist
library <https://pypi.python.org/pypi/python-hostlist>`_ is
required. It's not available in Anaconda, but you can install it with
pip, like "pip install -U --user python-hostlist".

To generate graphviz output (the default), one needs the pydot
library.


Usage example on triton.aalto.fi
================================

1. run `ibnetdiscover > ibnetdiscover.txt` on the login node (as root?)
2. install dependencies of ibtopotool, e.g. `module load anaconda` and `pip install --user pydot`
3. run `python ibtopotool.py ibnetdiscover.txt > ibnetdiscover.graphviz`
4. run `circo -Tsvg -O ibnetdiscover.graphviz`
